// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace RSV_dashboard.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using RSV_dashboard;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using RSV_dashboard.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\_Imports.razor"
using MudBlazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\Pages\ConfigBot.razor"
using RSV_dashboard.Bot.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\Pages\ConfigBot.razor"
using RSV_dashboard.Bot.Models.Tasks;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/ConfigBot")]
    public partial class ConfigBot : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 132 "D:\Университет\4 семестр\Коллективная ID-деятельность\Collective-IT-Development\RSV_dashboard\RSV_dashboard\Pages\ConfigBot.razor"
       
    private bool showFAQ { get; set; } = false;
    private bool testChat { get; set; } = false;
    private string showFAQLabel { get; set; } = "Отобразить редактор";
    string fileName { get; set; } = "Bot//TestingBots//Configs//rsvBot.json";
    Bot.Models.BotConfig config { get; set; }

    MudMessageBox mbox { get; set; }
    private string tempTextfield;
    private IEnumerable<Conversation> Conversations = new List<Conversation>();

    private async void OnButtonClicked()
    {
        bool? result = await mbox.Show();
        StateHasChanged();
    }

    protected override void OnInitialized()
    {

        var text = System.IO.File.ReadAllText(fileName);
        Newtonsoft.Json.JsonSerializerSettings settings = new Newtonsoft.Json.JsonSerializerSettings()
        {
            TypeNameHandling = Newtonsoft.Json.TypeNameHandling.Auto

        };


        config = Newtonsoft.Json.JsonConvert.DeserializeObject<Bot.Models.BotConfig>(text, settings);

    }
    private void ShowFAQ()
    {
        showFAQ = !showFAQ;

        if (showFAQ)
        {
            showFAQLabel = "Скрыть редактор";
        }
        else
        {
            showFAQLabel = "Показать редактор";
        }
    }

    private void AddFAQ()
    {
        var newFAQ = new Bot.Models.Tasks.Conversation();
        newFAQ.Name = $"newFAQ{DateTime.Now.ToString("MMddyy.hhmmss")}";
        newFAQ.AddUtterance("");
        newFAQ.AddResponse("");
        config.Conversations.Add(newFAQ);
    }

    private void DeleteFAQ(Guid faqId)
    {
        config.Conversations.RemoveAll(f => f.ID == faqId);
    }

    private void DeleteUtterance(Guid faqId, Guid utteranceID)
    {
        var faq = config.Conversations.Where(f => f.ID == faqId).FirstOrDefault();
        faq.StartNode.Utterances.RemoveAll(f => f.ID == utteranceID);
    }

    private void DeleteResponse(Guid faqId, Guid responseID)
    {
        var faq = config.Conversations.Where(f => f.ID == faqId).FirstOrDefault();
        faq.ReplyNode.Responses.RemoveAll(f => f.ID == responseID);
    }

    private void AddUtterance(Guid faqId)
    {
        var faq = config.Conversations.Where(f => f.ID == faqId).FirstOrDefault();
        faq.AddUtterance("");
    }
    private void AddSynonym(Guid faqId)
    {
        var faq = config.Conversations.Where(f => f.ID == faqId).FirstOrDefault();
        faq.AddSynonym("", "");
    }
    private void DeleteSynonym(Guid faqId, Guid synonymID)
    {
        var faq = config.Conversations.Where(f => f.ID == faqId).FirstOrDefault();
        faq.StartNode.Synonyms.RemoveAll(f => f.ID == synonymID);
    }
    private void AddResponse(Guid faqId)
    {
        var faq = config.Conversations.Where(f => f.ID == faqId).FirstOrDefault();
        faq.AddResponse("");
    }

    private void SaveConfig()
    {
        config.Save();
        //Modal.Show("Saved!", typeof(Bot.Components.Modals.SaveComplete));
        OnButtonClicked();
    }

    private void TrainModel()
    {
        var trainingResult = Bot.Services.Platform.AIService.Train(config);
        config.ModelFile = trainingResult;
        config.Save();
        //Modal.Show("Great News!", typeof(Bot.Components.Modals.TrainingComplete));
        OnButtonClicked();
    }

    private void TestChat()
    {
        testChat = !testChat;
    }



#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
